{% extends "base.html" %}

{% block title %}AI Model Security Scanner - ì‘ì—… ëª©ë¡{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ì‘ì—… ëª©ë¡</h1>
    <p>ì´ì „ ìŠ¤ìº” ì‘ì—… ë‚´ì—­ì„ í™•ì¸í•˜ì„¸ìš”</p>
</div>

<div class="jobs-section">
    {% if jobs %}
    <div class="jobs-table-container">
        <table class="jobs-table">
            <thead>
                <tr>
                    <th>íŒŒì¼ëª…</th>
                    <th>ìƒíƒœ</th>
                    <th>ê²°ê³¼</th>
                    <th>ìƒì„±ì¼</th>
                    <th>ì‘ì—…</th>
                </tr>
            </thead>
            <tbody>
                {% for job in jobs %}
                <tr class="job-row" onclick="window.location='/jobs/{{ job.job_id }}'">
                    <td class="job-filename">
                        <span class="file-icon">ğŸ“„</span>
                        {{ job.filename }}
                    </td>
                    <td>
                        <span class="status-badge status-{{ job.status }}">
                            {% if job.status == 'queued' %}â³ ëŒ€ê¸°ì¤‘
                            {% elif job.status == 'running' %}ğŸ”„ ì§„í–‰ì¤‘
                            {% elif job.status == 'succeeded' %}âœ… ì™„ë£Œ
                            {% elif job.status == 'failed' %}âŒ ì‹¤íŒ¨
                            {% endif %}
                        </span>
                    </td>
                    <td>
                        {% if job.pass_fail %}
                        <span class="result-badge result-{{ job.pass_fail | lower }}">
                            {% if job.pass_fail == 'PASS' %}âœ“ PASS{% else %}âœ— FAIL{% endif %}
                        </span>
                        {% else %}
                        <span class="result-badge result-pending">-</span>
                        {% endif %}
                    </td>
                    <td class="job-date">{{ job.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td class="job-actions">
                        <a href="/jobs/{{ job.job_id }}" class="btn-view" onclick="event.stopPropagation()">ìƒì„¸</a>
                        <button class="btn-delete"
                            onclick="event.stopPropagation(); deleteJob('{{ job.job_id }}')">ì‚­ì œ</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">ğŸ“‹</div>
        <h3>ì‘ì—… ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</h3>
        <p>ìƒˆë¡œìš´ ëª¨ë¸ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë³´ì•ˆ ìŠ¤ìº”ì„ ì‹œì‘í•˜ì„¸ìš”</p>
        <a href="/" class="btn-primary">ìŠ¤ìº” ì‹œì‘</a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>
    async function deleteJob(jobId) {
        if (!confirm('ì´ ì‘ì—…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            return;
        }

        try {
            const response = await fetch(`/api/jobs/${jobId}`, {
                method: 'DELETE'
            });

            if (response.ok) {
                location.reload();
            } else {
                alert('ì‚­ì œ ì‹¤íŒ¨');
            }
        } catch (error) {
            alert('ì˜¤ë¥˜: ' + error.message);
        }
    }
</script>
{% endblock %}